<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trabajando con MÃ³dulos de Terraform - JosÃ© Navarro PavÃ³n</title>
    <link id="favicon" rel="icon" href="../../media/logo-url-dark.png" type="image/x-icon">
    <link rel="stylesheet" href="../../css/styles-generic.css">
    <link rel="stylesheet" href="../../css/styles-labs.css">
    <link rel="stylesheet" href="../../css/styles-lab-detail.css">
    <link rel="stylesheet" href="../../css/fonts.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200..900&family=Oswald:wght@200..700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
</head>

<body class="dark-mode">
    <header id="header">
        <a href="../index.html" class="logo-link">
            <img src="../../media/logo-url-dark.png" class="logo">
        </a>
        <div class="header-buttons"> 
            <nav>
                <ul class="nav-list">
                    <li><a href="../index.html">Inicio</a></li>
                    <li><a href="../laboratories.html">Laboratorios</a></li>
                    <li><a href="../collaborations.html">Colaboraciones</a></li>
                    <li><a href="../cv.html">CV</a></li>
                    <li><a href="../contact.html">Contacto</a></li>
                </ul>
            </nav>
            <div class="language-toggle-container">
                <span class="language-option" data-lang="en">EN</span>
                <span class="language-separator">|</span>
                <span class="language-option active" data-lang="es">ES</span>
            </div>
            <div class="theme-toggle-container">
                <i class="fas fa-sun sun-icon"></i>
                <div class="moving-bar" id="toggle-bar">
                  <div class="slider-point"></div>
                </div>
                <i class="fas fa-moon moon-icon"></i>
            </div>
        </div>
    </header>
    
    <!-- Breadcrumb Navigation -->
    <div class="breadcrumb">
        <a href="../laboratories.html">Laboratorios</a> 
        <span class="breadcrumb-separator">></span>
        <span class="breadcrumb-current">Trabajando con MÃ³dulos de Terraform</span>
    </div>
    
    <div style="height: 2rem;"></div>
    
    <!-- Lab Header -->
    <div class="lab-header">
        <div class="lab-header-content">
            <div class="lab-header-info">
                <h1 class="lab-main-title">Trabajando con MÃ³dulos de Terraform</h1>
                <p class="lab-main-description">
                    Aprende a organizar tu cÃ³digo de Terraform usando mÃ³dulos para mejor estructura y reutilizaciÃ³n. 
                    Esta guÃ­a cubre lo bÃ¡sico de crear y usar mÃ³dulos para infraestructura de AWS.
                </p>
                <div class="lab-main-tech-tags">
                    <span class="tag-terraform">Terraform</span>
                    <span class="tag-aws">AWS</span>
                </div>
                <div class="lab-links">
                    <a href="https://github.com/LiReXz/How-to-work-with-Terraform-Modules" target="_blank" class="lab-link github-link">
                        <i class="fab fa-github"></i> Ver en GitHub
                    </a>
                </div>
            </div>
            <div class="lab-header-media">
                <div class="terraform-diagram">
                    <i class="fas fa-cubes" style="font-size: 8rem; color: #7B42BC;"></i>
                </div>
            </div>
        </div>
    </div>
    
    <div style="height: 4rem;"></div>
    
    <!-- Overview Section -->
    <div class="lab-section">
        <h2 class="section-title">ğŸ” Lo que AprenderÃ¡s</h2>
        <div class="content-grid">
            <div class="content-card">
                <h3>Conceptos BÃ¡sicos</h3>
                <ul>
                    <li><strong>QuÃ© son los MÃ³dulos</strong> - Entender el concepto de mÃ³dulos en Terraform</li>
                    <li><strong>Estructura del Proyecto</strong> - CÃ³mo organizar tus archivos de Terraform</li>
                    <li><strong>Ejemplos Simples</strong> - MÃ³dulos bÃ¡sicos de compute, red e IAM</li>
                    <li><strong>Variables</strong> - CÃ³mo pasar datos entre mÃ³dulos</li>
                </ul>
            </div>
            <div class="content-card">
                <h3>Ejemplo PrÃ¡ctico</h3>
                <ul>
                    <li><strong>MÃ³dulo de Red:</strong> Crear VPCs y subnets</li>
                    <li><strong>MÃ³dulo Compute:</strong> Configurar instancias EC2</li>
                    <li><strong>MÃ³dulo IAM:</strong> Gestionar accesos y permisos</li>
                    <li><strong>Conectar Todo:</strong> Vincular mÃ³dulos entre sÃ­</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div style="height: 3rem;"></div>
    
    <!-- Architecture Section -->
    <div class="lab-section">
        <h2 class="section-title">ğŸ—ï¸ Arquitectura de MÃ³dulos</h2>
        <div class="architecture-flow">
            <div class="flow-step">
                <div class="flow-icon">âš™ï¸</div>
                <h4>1. MÃ³dulo RaÃ­z</h4>
                <p>ConfiguraciÃ³n principal con proveedor y declaraciones de mÃ³dulos</p>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
                <div class="flow-icon">ğŸ”</div>
                <h4>2. MÃ³dulo IAM</h4>
                <p>Recursos de identidad y gestiÃ³n de accesos</p>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
                <div class="flow-icon">ğŸŒ</div>
                <h4>3. MÃ³dulo Network</h4>
                <p>VPCs, subnets, grupos de seguridad, enrutamiento</p>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
                <div class="flow-icon">ğŸ’»</div>
                <h4>4. MÃ³dulo Compute</h4>
                <p>Instancias EC2, balanceadores de carga, plantillas</p>
            </div>
        </div>
    </div>
    
    <div style="height: 3rem;"></div>
    
    <!-- Project Structure Section -->
    <div class="lab-section">
        <h2 class="section-title">ğŸ“ Estructura del Proyecto</h2>
        <div class="code-block">
            <pre><code>terraform-modules/
â”œâ”€â”€ main.tf                    # ConfiguraciÃ³n del mÃ³dulo raÃ­z
â”œâ”€â”€ variables.tf               # Variables raÃ­z
â”œâ”€â”€ compute/                   # MÃ³dulo de recursos de cÃ³mputo
â”‚   â”œâ”€â”€ inputs.tf             # Variables de entrada del mÃ³dulo
â”‚   â”œâ”€â”€ main.tf               # Dependencias del mÃ³dulo
â”‚   â”œâ”€â”€ instances.tf          # Instancias EC2
â”‚   â”œâ”€â”€ launch_templates.tf   # Plantillas de lanzamiento
â”‚   â”œâ”€â”€ load_balancing.tf     # Balanceadores de carga
â”‚   â”œâ”€â”€ lambda.tf             # Funciones Lambda
â”‚   â””â”€â”€ locals.tf             # Variables locales
â”œâ”€â”€ network/                   # MÃ³dulo de recursos de red
â”‚   â”œâ”€â”€ outputs.tf            # Salidas del mÃ³dulo
â”‚   â”œâ”€â”€ vpcs.tf               # Definiciones VPC
â”‚   â”œâ”€â”€ subnets.tf            # Configuraciones de subnets
â”‚   â”œâ”€â”€ route_tables.tf       # Tablas de enrutamiento
â”‚   â”œâ”€â”€ security_groups.tf    # Grupos de seguridad
â”‚   â”œâ”€â”€ internet_gateway.tf   # Gateways de internet
â”‚   â”œâ”€â”€ elastic_ips.tf        # Direcciones IP elÃ¡sticas
â”‚   â””â”€â”€ network_interfaces.tf # Interfaces de red
â””â”€â”€ iam/                       # MÃ³dulo de recursos IAM
    â”œâ”€â”€ iam_roles.tf          # Roles y polÃ­ticas IAM
    â”œâ”€â”€ key_pair.tf           # Pares de claves EC2
    â””â”€â”€ outputs.tf            # Salidas del mÃ³dulo</code></pre>
        </div>
    </div>
    
    <div style="height: 3rem;"></div>
    
    <!-- Setup Guide Section -->
    <div class="lab-section">
        <h2 class="section-title">ğŸš€ GuÃ­a de ConfiguraciÃ³n</h2>
        
        <div class="setup-section">
            <h3>Requisitos Previos</h3>
            <div class="checklist">
                <div class="checklist-item">âœ… Cuenta de AWS con permisos apropiados</div>
                <div class="checklist-item">âœ… Terraform instalado (v1.0+)</div>
                <div class="checklist-item">âœ… AWS CLI configurado</div>
                <div class="checklist-item">âœ… ComprensiÃ³n bÃ¡sica de servicios AWS</div>
            </div>
        </div>
        
        <div class="setup-section">
            <h3>1. Clonar Repositorio</h3>
            <div class="code-block">
                <pre><code>git clone https://github.com/LiReXz/How-to-work-with-Terraform-Modules.git
cd How-to-work-with-Terraform-Modules</code></pre>
            </div>
        </div>
        
        <div class="setup-section">
            <h3>2. Configurar Credenciales de AWS</h3>
            <p>Actualiza el archivo <strong>variables.tf</strong> con tus credenciales de AWS:</p>
            <div class="code-block">
                <pre><code>variable "region" {
    type = string
    default = "us-east-1"  # Tu regiÃ³n preferida
}

variable "accessKey" {
    type = string
    default = "TU_CLAVE_DE_ACCESO"
}

variable "secretKey" {
    type = string
    default = "TU_CLAVE_SECRETA"
}</code></pre>
            </div>
        </div>
        
        <div class="setup-section">
            <h3>3. Inicializar Terraform</h3>
            <div class="code-block">
                <pre><code># Inicializar Terraform y descargar proveedores
terraform init

# Validar la configuraciÃ³n
terraform validate

# Planificar el despliegue
terraform plan</code></pre>
            </div>
        </div>
        
        <div class="setup-section">
            <h3>4. Desplegar Infraestructura</h3>
            <div class="code-block">
                <pre><code># Aplicar la configuraciÃ³n
terraform apply

# Confirmar con 'yes' cuando se solicite

# Para destruir recursos cuando termines
terraform destroy</code></pre>
            </div>
        </div>
    </div>
    
    <div style="height: 3rem;"></div>
    
    <!-- Module Details Section -->
    <div class="lab-section">
        <h2 class="section-title">ğŸ”§ ImplementaciÃ³n de MÃ³dulos</h2>
        
        <div class="module-section">
            <h3>MÃ³dulo RaÃ­z (main.tf)</h3>
            <p>El mÃ³dulo raÃ­z orquesta todos los demÃ¡s mÃ³dulos y gestiona las dependencias:</p>
            <div class="code-block">
                <pre><code># ConfiguraciÃ³n del proveedor
terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 4.0"
    }
  }
}

provider "aws" {
  region = var.region
  access_key = var.accessKey
  secret_key = var.secretKey
}

# Declaraciones de mÃ³dulos con dependencias
module "iam" {
    source = "./iam"
}

module "network" {
    source = "./network"
}

module "compute" {
    source = "./compute"
    depends_on = [module.iam, module.network]
    
    # Transferencia de variables desde otros mÃ³dulos
    key-pair-example1 = module.iam.key-pair-example1
    example1-vpc-id = module.network.example1-vpc-id
    example1-subnet-id = module.network.example1-subnet-id
}</code></pre>
            </div>
        </div>
        
        <div class="module-section">
            <h3>Proceso de Transferencia de Variables</h3>
            <p>Aprende cÃ³mo pasar variables entre mÃ³dulos:</p>
            
            <div class="variable-step">
                <h4>Paso 1: Definir Salidas (MÃ³dulo Fuente)</h4>
                <div class="code-block">
                    <pre><code># network/outputs.tf
output "example1-vpc-id" {
    value = aws_vpc.example1-vpc.id
    description = "ID del VPC de ejemplo"
}

output "example1-subnet-id" {
    value = aws_subnet.example1-subnet.id
    description = "ID de la subnet de ejemplo"
}</code></pre>
                </div>
            </div>
            
            <div class="variable-step">
                <h4>Paso 2: Definir Entradas (MÃ³dulo Destino)</h4>
                <div class="code-block">
                    <pre><code># compute/inputs.tf
variable "example1-vpc-id" {
    description = "ID del VPC desde el mÃ³dulo de red"
    type = string
}

variable "example1-subnet-id" {
    description = "ID de la subnet desde el mÃ³dulo de red"
    type = string
}</code></pre>
                </div>
            </div>
            
            <div class="variable-step">
                <h4>Paso 3: Conectar Variables (MÃ³dulo RaÃ­z)</h4>
                <div class="code-block">
                    <pre><code># main.tf - Transferencia de variables
module "compute" {
    source = "./compute"
    depends_on = [module.network]
    
    example1-vpc-id = module.network.example1-vpc-id
    example1-subnet-id = module.network.example1-subnet-id
}</code></pre>
                </div>
            </div>
        </div>
    </div>
    
    <div style="height: 3rem;"></div>
    
    <!-- Best Practices Section -->
    <div class="lab-section">
        <h2 class="section-title">ğŸ’¡ Mejores PrÃ¡cticas</h2>
        
        <div class="best-practices-grid">
            <div class="practice-card">
                <h4>ğŸ—‚ï¸ OrganizaciÃ³n de Archivos</h4>
                <ul>
                    <li>Separar recursos por tipo (cÃ³mputo, red, IAM)</li>
                    <li>Usar nombres descriptivos (instances.tf, security_groups.tf)</li>
                    <li>Mantener main.tf solo para dependencias</li>
                    <li>Usar locals.tf para variables especÃ­ficas del mÃ³dulo</li>
                </ul>
            </div>
            
            <div class="practice-card">
                <h4>ğŸ”„ Dependencias de MÃ³dulos</h4>
                <ul>
                    <li>Usar declaraciones explÃ­citas <code>depends_on</code></li>
                    <li>Evitar dependencias circulares entre mÃ³dulos</li>
                    <li>Planificar el orden de ejecuciÃ³n (IAM â†’ Network â†’ Compute)</li>
                    <li>Probar dependencias con <code>terraform graph</code></li>
                </ul>
            </div>
            
            <div class="practice-card">
                <h4>ğŸ“ Nomenclatura de Variables</h4>
                <ul>
                    <li>Usar convenciones de nombres descriptivas y consistentes</li>
                    <li>Incluir tipo de recurso en nombres de variables</li>
                    <li>Documentar todas las variables con descripciones</li>
                    <li>Usar tipos de variables apropiados (string, number, list)</li>
                </ul>
            </div>
            
            <div class="practice-card">
                <h4>ğŸ” Consideraciones de Seguridad</h4>
                <ul>
                    <li>Nunca hardcodear credenciales sensibles</li>
                    <li>Usar roles IAM de AWS cuando sea posible</li>
                    <li>Implementar principios de menor privilegio</li>
                    <li>Almacenar archivos de estado de forma segura (S3 backend recomendado)</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div style="height: 3rem;"></div>
    
    <!-- Troubleshooting Section -->
    <div class="lab-section">
        <h2 class="section-title">ğŸ”§ ResoluciÃ³n de Problemas</h2>
        
        <div class="troubleshooting-section">
            <div class="issue-item">
                <h4>Problema ComÃºn: MÃ³dulo No Encontrado</h4>
                <p><strong>Error:</strong> <code>Module not found: ./compute</code></p>
                <p><strong>SoluciÃ³n:</strong> AsegÃºrate de que la ruta del mÃ³dulo sea correcta y ejecuta <code>terraform init</code> para inicializar mÃ³dulos.</p>
            </div>
            
            <div class="issue-item">
                <h4>Problema ComÃºn: Dependencias Circulares</h4>
                <p><strong>Error:</strong> <code>Cycle: module.compute, module.network</code></p>
                <p><strong>SoluciÃ³n:</strong> Revisa y elimina dependencias circulares. Usa <code>terraform graph</code> para visualizar dependencias.</p>
            </div>
            
            <div class="issue-item">
                <h4>Problema ComÃºn: Variable No Definida</h4>
                <p><strong>Error:</strong> <code>Variable "example1-vpc-id" not declared</code></p>
                <p><strong>SoluciÃ³n:</strong> AsegÃºrate de que la variable estÃ© declarada en <code>inputs.tf</code> del mÃ³dulo destino.</p>
            </div>
        </div>
    </div>
    
    <div style="height: 4rem;"></div>
    
    <!-- Back Navigation -->
    <div class="back-navigation">
        <a href="../laboratories.html" class="back-link">
            <i class="fas fa-arrow-left"></i> Volver a Laboratorios
        </a>
    </div>
    
    <div style="height: 4rem;"></div>

    <script src="../../scripts/theme.js"></script>
    <script src="../../scripts/language-toggle.js"></script>
    <script src="../../scripts/scroll.js"></script>
    <script src="../../scripts/lab-detail.js"></script>
    <script src="../../scripts/tag-sorter.js"></script>
</body>
</html>
